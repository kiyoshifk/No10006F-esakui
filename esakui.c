#include "disp.c"
#include "os_call.c"
#include "string.c"
#include "mt19937ar.c"

//
//	１駒のサイズを 24x24 ドットにする
//	１駒の中に 壁、通路、餌 が固定で配置される
//	画面は 448x320 ドット、最上部に 32ドットメッセージエリア
//	盤は縦12駒 横12駒とする
//


const char mon1[24][24]={					// モンスター１
//      |         |        |        |         |
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,1,1,0,0,0,0,1,1,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,0,0,0,0,
	0,0,0,0,0,0,1,0,0,0,1,0,0,1,0,0,0,1,0,0,0,0,0,0,
	0,0,0,0,0,0,1,0,1,0,0,1,1,0,0,1,0,1,0,0,0,0,0,0,
	0,0,0,0,0,1,0,0,1,1,0,1,1,0,1,1,0,0,1,0,0,0,0,0,
	0,0,0,0,0,1,0,0,1,1,0,1,1,0,1,1,0,0,1,0,0,0,0,0,
	0,0,0,0,1,0,1,0,1,0,0,1,1,0,0,1,0,1,0,1,0,0,0,0,
	0,0,0,0,1,0,1,0,0,0,1,0,0,1,0,0,0,1,0,1,0,0,0,0,
	0,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,0,
	0,0,0,1,0,0,0,0,1,1,0,0,0,0,1,1,0,0,0,0,1,0,0,0,
	0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,	//
	0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,
	0,0,1,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,1,0,0,
	0,1,0,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,0,1,0,
	0,1,0,0,1,1,0,0,1,1,0,0,0,0,1,1,0,0,1,1,0,0,1,0,
	0,1,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,1,0,
	0,1,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,1,0,
	0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,
	0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,
	0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,
	0,0,0,0,0,1,0,0,1,0,1,0,0,1,0,1,0,0,1,0,0,0,0,0,
	0,0,0,0,0,0,1,1,0,0,0,1,1,0,0,0,1,1,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
//      |         |        |        |         |
};
const char mon2[24][24]={					// モンスター２
//      |         |        |        |         |
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,1,1,0,0,0,0,1,1,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,0,0,0,0,
	0,0,0,0,0,0,1,0,0,0,1,0,0,1,0,0,0,1,0,0,0,0,0,0,
	0,0,0,0,0,0,1,0,1,0,0,1,1,0,0,1,0,1,0,0,0,0,0,0,
	0,0,0,0,0,1,0,0,1,1,0,1,1,0,1,1,0,0,1,0,0,0,0,0,
	0,0,0,0,0,1,0,0,1,1,0,1,1,0,1,1,0,0,1,0,0,0,0,0,
	0,0,0,0,1,0,1,0,1,0,0,1,1,0,0,1,0,1,0,1,0,0,0,0,
	0,0,0,0,1,0,1,0,0,0,1,0,0,1,0,0,0,1,0,1,0,0,0,0,
	0,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,0,
	0,0,0,1,0,0,0,0,1,1,0,0,0,0,1,1,0,0,0,0,1,0,0,0,
	0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,	//
	0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,
	0,0,1,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,1,0,0,
	0,1,0,0,0,1,1,1,0,0,1,1,1,1,0,0,1,1,1,0,0,0,1,0,
	0,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,0,
	0,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0,
	0,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,0,
	0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,
	0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,
	0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,
	0,0,0,0,0,1,1,1,1,0,1,1,1,1,0,1,1,1,1,0,0,0,0,0,
	0,0,0,0,0,0,1,1,0,0,0,1,1,0,0,0,1,1,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
//      |         |        |        |         |
};
const char mon3[24][24]={					// モンスター３
//      |         |        |        |         |
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,1,1,0,0,0,0,1,1,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,0,0,0,0,
	0,0,0,0,0,0,1,0,0,0,1,0,0,1,0,0,0,1,0,0,0,0,0,0,
	0,0,0,0,0,0,1,0,1,0,0,1,1,0,0,1,0,1,0,0,0,0,0,0,
	0,0,0,0,0,1,0,0,1,1,0,1,1,0,1,1,0,0,1,0,0,0,0,0,
	0,0,0,0,0,1,0,0,1,1,0,1,1,0,1,1,0,0,1,0,0,0,0,0,
	0,0,0,0,1,0,1,0,1,0,0,1,1,0,0,1,0,1,1,1,0,0,0,0,
	0,0,0,0,1,1,1,0,0,0,1,1,0,1,0,0,0,1,0,1,0,0,0,0,
	0,0,0,1,1,0,1,1,0,0,1,0,1,1,0,0,1,0,1,0,1,0,0,0,
	0,0,0,1,0,1,0,1,1,1,0,1,0,1,1,1,0,1,0,1,1,0,0,0,
	0,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,1,0,0,	//
	0,0,1,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,0,
	0,0,1,0,1,0,1,0,1,0,1,1,1,0,1,0,1,0,1,0,1,1,0,0,
	0,1,0,1,0,1,0,1,0,1,1,1,1,1,0,1,1,1,1,1,0,1,1,0,
	0,1,1,0,1,1,1,1,1,1,1,0,1,1,1,1,1,0,1,1,1,0,1,0,
	0,1,0,1,0,1,0,1,1,1,0,1,0,1,1,1,0,1,1,0,1,1,1,0,
	0,1,1,0,0,1,1,0,1,0,1,0,1,0,1,0,1,0,1,0,0,1,1,0,
	0,0,0,0,1,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,0,0,0,
	0,0,0,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,1,0,0,0,0,
	0,0,0,0,1,1,0,1,0,1,0,1,0,1,1,1,0,1,0,1,0,0,0,0,
	0,0,0,0,0,1,1,0,1,0,1,0,1,1,0,1,1,0,1,0,0,0,0,0,
	0,0,0,0,0,0,1,1,0,0,0,1,1,0,0,0,1,1,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
//      |         |        |        |         |
};
const char pac0[24][24]={
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,
	0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,
	0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,
	0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,
	0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,
	0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,
	0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,
	0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,
	0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,
	0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,
	0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,
	0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,
	0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,
	0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,
	0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,
	0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,
	0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,
	0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,
	0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,
	0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
};
const char pac1[24][24]={
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,
	0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,
	0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,
	0,0,1,1,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,1,1,0,0,
	0,0,1,1,1,1,1,1,1,0,0,0,0,0,0,1,1,1,1,1,1,1,0,0,
	0,1,1,1,1,1,1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1,1,0,
	0,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,0,
	0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,
	0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,
	0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,
	0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,
	0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,
	0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,
	0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,
	0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,
	0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,
	0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,
	0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
};
const char pac2[24][24]={
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,
	0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,
	0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,
	0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,
	0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,
	0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,
	0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,
	0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,
	0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,
	0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,
	0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,
	0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,
	0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,
	0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,
	0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,
	0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,
	0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,
	0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,
	0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,
	0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
};
const char pac3[24][24]={
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,
	0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,
	0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,
	0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,
	0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,
	0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,
	0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,
	0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,
	0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,
	0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,
	0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,
	0,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,0,
	0,1,1,1,1,1,1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1,1,0,
	0,0,1,1,1,1,1,1,1,0,0,0,0,0,0,1,1,1,1,1,1,1,0,0,
	0,0,1,1,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,1,1,0,0,
	0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,
	0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,
	0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
};
const char pac4[24][24]={
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,
	0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,
	0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,
	0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,
	0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,
	0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,
	0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,
	0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,
	0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,
	0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,
	0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,
	0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,
	0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,
	0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,
	0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,
	0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,
	0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,
	0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,
	0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,
	0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
};
const char patN[24][24]={
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
};
const char patK[24][24]={
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
};
const char patE[24][24]={
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
};

#define SCRN_TOP		0xa0000000

#define N				0	// 何もなし
#define K				1	// 壁
#define E				2	// 餌

//#define X_SIZE			12
//#define Y_SIZE			12
//const char init_ban[Y_SIZE][X_SIZE]={
//	K,K,K,K,K,K,K,K,K,K,K,K,
//	K,E,E,E,E,E,K,E,E,E,E,K,
//	K,E,K,E,K,E,K,E,K,K,E,K,
//	K,E,E,E,K,E,K,E,K,E,E,K,
//	K,E,K,E,E,E,E,E,E,E,K,K,
//	K,E,K,E,K,E,K,E,K,E,E,K,
//	K,E,E,E,K,K,K,E,K,K,E,K,
//	K,K,K,E,E,E,E,E,E,E,E,K,
//	K,E,E,E,K,E,K,K,E,K,E,K,
//	K,E,K,E,K,E,E,E,E,K,E,K,
//	K,E,E,E,E,E,K,K,E,E,E,K,
//	K,K,K,K,K,K,K,K,K,K,K,K,};
//#define PAC_INIT_POS_X	11
//#define PAC_INIT_POS_Y	11
//#define MON_INIT_POS_X	6
//#define MON_INIT_POS_Y	6

#define X_SIZE			22
#define Y_SIZE			22
const char init_ban[Y_SIZE][X_SIZE]={
	K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,
	K,E,E,E,E,E,E,E,E,E,K,E,E,E,E,E,E,E,E,E,E,K,
	K,E,K,K,K,E,K,K,K,E,K,E,K,K,K,E,K,E,K,K,E,K,
	K,E,K,K,K,E,K,K,K,E,K,E,K,K,K,E,K,E,K,K,E,K,
	K,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,K,
	K,K,K,K,K,E,K,E,K,K,K,K,K,E,K,E,K,K,K,K,E,K,
	K,K,K,K,K,E,K,E,K,K,K,K,K,E,K,E,K,K,K,K,E,K,
	K,E,E,E,E,E,K,E,E,E,K,E,E,E,K,E,E,E,E,E,E,K,
	K,E,K,K,K,E,K,K,K,E,K,E,K,K,K,E,K,K,E,K,K,K,
	K,E,K,N,K,E,K,E,E,E,E,E,E,E,K,E,K,E,E,E,E,K,
	K,E,K,K,K,E,K,E,K,K,E,K,K,E,K,E,K,E,K,K,E,K,
	K,E,E,E,E,E,E,E,K,E,E,E,K,E,K,E,K,E,K,K,E,K,
	K,E,K,K,K,K,K,E,K,K,K,K,K,E,E,E,E,E,E,E,E,K,
	K,E,K,K,K,K,K,E,E,E,E,E,E,E,K,K,K,K,K,E,K,K,
	K,E,E,E,K,E,E,E,K,K,K,K,K,E,K,K,K,K,K,E,K,K,
	K,K,K,E,K,E,K,E,K,K,K,K,K,E,E,E,E,E,E,E,E,K,
	K,E,E,E,E,E,K,E,E,E,K,K,E,E,E,K,E,K,K,K,K,K,
	K,E,K,K,K,E,K,K,K,E,E,E,E,K,E,K,E,E,E,E,E,K,
	K,E,K,N,K,E,K,K,K,E,K,K,E,K,E,K,E,K,K,K,E,K,
	K,E,K,K,K,E,E,E,E,E,K,K,E,K,E,K,E,K,K,K,E,K,
	K,E,E,E,E,E,K,K,K,E,E,E,E,K,E,E,E,E,E,E,E,K,
	K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,
};
#define PAC_INIT_POS_X	21
#define PAC_INIT_POS_Y	21
#define MON_INIT_POS_X	11
#define MON_INIT_POS_Y	12

char xpos, ypos;							// 1〜X_SIZE/Y_SIZE
char mon_pos[4][2];
int score;
int video[320][10];
char ban[Y_SIZE][X_SIZE];
int level;

/********************************************************************************/
/*		Psetx																	*/
/********************************************************************************/
void Psetx(int x, int y, int c)
{
	int bit;
	int xx;
	
	if(x<0 || x>=320 || y<0 || y>=320)
		return;							// out of range
//	y = 319-y;
	xx = (x>>5) & 0xff;
	bit = 0x80000000 >> (x & 0x1f);
	if(c)
		video[y][xx] |= bit;
	else
		video[y][xx] &= ~bit;
}
/********************************************************************************/
/*		disp_pat																*/
/********************************************************************************/
void disp_pat(int x, int y, char pat[24][24])
{
	int xx, yy;
	
	x = (x-1)*14;						// この値に +12 で中心
	y = (y-1)*14;
	for(yy=0; yy<24; yy++){
		for(xx=0; xx<24; xx++){
			Psetx(x+xx, y+yy, pat[yy][xx]);
		}
	}
}
/********************************************************************************/
/*		disp_ban																*/
/********************************************************************************/
void disp_ban1(int x, int y)
{
	int i, k, xx, yy;
	
	xx = (x-1)*14+(12-1);
	yy = (y-1)*14+(12-1);
	k = ban[y-1][x-1];
	if(k==E){
		disp_pat(x, y, patE);
	}
	else if(k==N){
		disp_pat(x, y, patN);
	}
	else if(k==K){
		if(ban[y-2][x-1]==K && y!=1){		// 上: 壁
			for(i=0; i<7; i++){
				Psetx(xx-1, yy-i, 1);
				Psetx(xx+2, yy-i, 1);
			}
		}
		else{								// 上: 壁ではない
			for(i=0; i<4; i++){
				Psetx(xx-1+i, yy-1, 1);
			}
			Psetx(xx-1, yy, 1);
			Psetx(xx+2, yy, 1);
		}

		if(ban[y-1][x-2]==K && x!=1){		// 左: 壁
			for(i=0; i<7; i++){
				Psetx(xx-i, yy-1, 1);
				Psetx(xx-i, yy+2, 1);
			}
		}
		else{								// 左: 壁ではない
			for(i=0; i<4; i++){
				Psetx(xx-1, yy-1+i, 1);
			}
			Psetx(xx, yy-1, 1);
			Psetx(xx, yy+2, 1);
		}
		
		if(ban[y][x-1]==K && y!=Y_SIZE){	// 下: 壁
			for(i=0; i<7; i++){
				Psetx(xx-1, yy+1+i, 1);
				Psetx(xx+2, yy+1+i, 1);
			}
		}
		else{								// 下: 壁ではない
			for(i=0; i<4; i++){
				Psetx(xx-1+i, yy+2, 1);
			}
			Psetx(xx-1, yy+1, 1);
			Psetx(xx+2, yy+1, 1);
		}
		
		if(ban[y-1][x]==K && x!=X_SIZE){	// 右: 壁
			for(i=0; i<7; i++){
				Psetx(xx+1+i, yy-1, 1);
				Psetx(xx+1+i, yy+2, 1);
			}
		}
		else{								// 右: 壁ではない
			for(i=0; i<4; i++){
				Psetx(xx+2, yy-1+i, 1);
			}
			Psetx(xx+1, yy-1, 1);
			Psetx(xx+1, yy+2, 1);
		}
	}
}

void disp_ban()
{
	int x, y;
	
	for(y=1; y<=Y_SIZE; y++){
		for(x=1; x<=X_SIZE; x++){
			disp_ban1(x, y);
		}
	}
}
/********************************************************************************/
/*		pac_move																*/
/********************************************************************************/
int pac_move()
{
	int c, x, y;
	
	x = xpos;
	y = ypos;
	c = get_APP_chA();
	if(c==UP){
		y--;
		if(y<1) y = 1;
	}
	else if(c==RIGHT){
		x++;
		if(x>X_SIZE) x = X_SIZE;
	}
	else if(c==DOWN){
		y++;
		if(y>Y_SIZE) y = Y_SIZE;
	}
	else if(c==LEFT){
		x--;
		if(x<1) x = 1;
	}
	if(ban[y-1][x-1] != K){						// 壁でなければ
		xpos = x;
		ypos = y;
		if(ban[ypos-1][xpos-1]==E){				// 餌を食べたら
			ban[ypos-1][xpos-1] = N;
			score += 10;						// 10点追加
			buzzer(1000, 20);					// 1KHz 20ms
		}
	}
	return c;
}
/********************************************************************************/
/*		pac_disp																*/
/********************************************************************************/
void pac_disp(int c)
{
	if(c==UP){
		disp_pat(xpos, ypos, pac1);
	}
	else if(c==RIGHT){
		disp_pat(xpos, ypos, pac2);
	}
	else if(c==DOWN){
		disp_pat(xpos, ypos, pac3);
	}
	else if(c==LEFT){
		disp_pat(xpos, ypos, pac4);
	}
	else{
		disp_pat(xpos, ypos, pac0);			// 口を閉じる
		return;
	}
}
/********************************************************************************/
/*		score_disp																*/
/********************************************************************************/
int score_disp()
{
	int i;
	
	cursor_set(54, 2);
	printf("Score");
	cursor_set(54, 3);
	printf("  %d", score);
	
	for(i=0; i<X_SIZE*Y_SIZE; i++){
		if(((char*)ban)[i]==E)				// まだ餌が残っている
			return 0;						// normal
	}
	return 1;								// １面クリアした
}
/********************************************************************************/
/*		video_disp																*/
/********************************************************************************/
void video_disp()
{
	int y;
	
	for(y=0; y<320; y++){
		memcpy((char*)(SCRN_TOP+y*(20*4)+4*4), video[y], 10*4);
	}
}
/********************************************************************************/
/*		erase_mon																*/
/********************************************************************************/
void erase_mon()
{
	int i;
	
	for(i=0; i<4; i++){
		disp_ban1(mon_pos[i][0], mon_pos[i][1]);	// 消す
	}
}
/********************************************************************************/
/*		move_mon																*/
/********************************************************************************/
int move_mon_x(int *x, int y)
{
	int r, xx;
	
	r = genrand_int31()%3;
	if(r==0){
inc1:;
		xx = *x+1;
		if(ban[y-1][xx-1]==K){				// 壁の為移動できない
			xx = *x-1;
			if(ban[y-1][xx-1]==K){			// 壁の為移動できない
				return 1;					// 移動できない
			}
		}
		*x = xx;
		return 0;							// 移動出来る
	}
	else if(r==1){
dec1:;
		xx = *x-1;
		if(ban[y-1][xx-1]==K){				// 壁の為移動できない
			xx = *x+1;
			if(ban[y-1][xx-1]==K){			// 壁の為移動できない
				return 1;					// 移動できない
			}
		}
		*x = xx;
		return 0;							// 移動出来る
	}
	else{
		if(*x > xpos)
			goto dec1;
		else if(*x < xpos)
			goto inc1;
		else
			return 1;						// 移動出来ない
	}
}

int move_mon_y(int x, int *y)
{
	int r, yy;
	
	r = genrand_int31()%3;
	if(r==0){
inc1:;
		yy = *y+1;
		if(ban[yy-1][x-1]==K){				// 壁の為移動できない
			yy = *y-1;
			if(ban[yy-1][x-1]==K){			// 壁の為移動できない
				return 1;					// 移動できない
			}
		}
		*y = yy;
		return 0;							// 移動出来る
	}
	else if(r==1){
dec1:;
		yy = *y-1;
		if(ban[yy-1][x-1]==K){				// 壁の為移動できない
			yy = *y+1;
			if(ban[yy-1][x-1]==K){			// 壁の為移動できない
				return 1;					// 移動できない
			}
		}
		*y = yy;
		return 0;							// 移動出来る
	}
	else{
		if(*y > ypos)
			goto dec1;
		else if(*y < ypos)
			goto inc1;
		else
			return 1;						// 移動出来ない
	}
}

void move_mon()
{
	int i, x, y;
	
	for(i=0; i<4; i++){
		if(genrand_int31()%100 < level)
			continue;
		x = mon_pos[i][0];
		y = mon_pos[i][1];
		if(genrand_int31()%100 < 50){
			if(move_mon_x(&x, y)){			// x 方向は移動できない
				move_mon_y(x, &y);
			}
		}
		else{
			if(move_mon_y(x, &y)){			// y 方向は移動できない
				move_mon_x(&x, y);
			}
		}
		mon_pos[i][0] = x;
		mon_pos[i][1] = y;
	}
}
/********************************************************************************/
/*		disp_mon																*/
/********************************************************************************/
int disp_mon()
{
	int i;
	
	disp_pat(mon_pos[0][0], mon_pos[0][1], mon1);
	disp_pat(mon_pos[1][0], mon_pos[1][1], mon2);
	disp_pat(mon_pos[2][0], mon_pos[2][1], mon2);
	disp_pat(mon_pos[3][0], mon_pos[3][1], mon3);
	
	for(i=0; i<4; i++){
		if(xpos==mon_pos[i][0] && ypos==mon_pos[i][1]){		// モンスターに掴まった
			buzzer(200, 1000);				// 200Hz 1秒
			cursor_set(54, 5);
			printf("Game over");
			cursor_set(54, 7);
			printf("push enter key");
			while(ut_getc() != '\n')
				;
			return 1;						// game over
		}
	}
	return 0;								// normal end
}
/********************************************************************************/
/*		main																	*/
/********************************************************************************/
int main()
{
	int c;
	unsigned int time1, time2;
	
	for(;;){
		scrn_clear();
		cursor_set(25,9);
		printf("餌食いゲーム");
		ut_getc();
		scrn_clear();
	
		init_genrand(GetTickCount());
		level = 50;
		score = 0;
		for(;;){
			memset(video, 0, sizeof(video));
			memcpy(ban, init_ban, sizeof(ban));
			disp_ban();							// 空の盤パターンセット
			xpos = PAC_INIT_POS_X;
			ypos = PAC_INIT_POS_Y;
			for(c=0; c<4; c++){
				mon_pos[c][0] = MON_INIT_POS_X;
				mon_pos[c][1] = MON_INIT_POS_Y;
			}
			time1 = GetTickCount();
			for(;;){
				disp_ban1(xpos, ypos);			// パックマンを消す
				c = pac_move();					// パックマン移動
				pac_disp(c);					// パックマンを表示する
				
				erase_mon();					// モンスターを消す
				move_mon();						// モンスター移動
				if(disp_mon())					// モンスターを表示する
					goto new_game;
				
				video_disp();
				if(score_disp())				// １面クリアした
					break;
				while((time2=GetTickCount())-time1 < 100)
					;
				time1 = time2;
			}
			level = 0;
		}
new_game:;
	}
}
